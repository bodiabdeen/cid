<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Blackwood Estate Mystery</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üïµÔ∏è</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1810 50%, #1a0a0a 100%);
            color: #d4c5a9;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.15) 0px,
                    transparent 1px,
                    transparent 2px,
                    rgba(0, 0, 0, 0.15) 3px
                );
            pointer-events: none;
            z-index: 1;
            animation: scan 8s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(10px); }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.95; }
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 10px #8b4513, 0 0 20px #8b4513; }
            50% { text-shadow: 0 0 20px #8b4513, 0 0 30px #8b4513, 0 0 40px #8b4513; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .detective-icon {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 48px;
            z-index: 1000;
            filter: drop-shadow(0 0 10px rgba(139, 69, 19, 0.8));
            animation: float 3s ease-in-out infinite;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(20, 10, 5, 0.9);
            border: 3px solid #8b4513;
            box-shadow: 
                0 0 30px rgba(139, 69, 19, 0.5),
                inset 0 0 50px rgba(0, 0, 0, 0.5);
            padding: 40px;
            position: relative;
            z-index: 2;
            animation: flicker 3s infinite;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, #8b4513, #cd853f, #8b4513);
            z-index: -1;
            border-radius: 2px;
        }

        header {
            text-align: center;
            border-bottom: 2px solid #8b4513;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 3em;
            color: #d4af37;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite;
        }

        .subtitle {
            font-size: 1.3em;
            color: #cd853f;
            font-style: italic;
            margin-bottom: 15px;
        }

        .case-number {
            font-family: 'Cinzel', serif;
            font-size: 0.9em;
            color: #8b7355;
            letter-spacing: 2px;
        }

        .warning-banner {
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #8b0000;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 0 20px rgba(139, 0, 0, 0.3);
        }

        .warning-banner h2 {
            font-family: 'Cinzel', serif;
            color: #ff6b6b;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .case-summary {
            background: rgba(40, 20, 10, 0.6);
            border-left: 4px solid #8b4513;
            padding: 25px;
            margin: 30px 0;
            line-height: 1.8;
            font-size: 1.1em;
        }

        .case-summary p {
            margin-bottom: 15px;
        }

        .evidence-section {
            margin: 40px 0;
        }

        h2 {
            font-family: 'Cinzel', serif;
            color: #d4af37;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 1px solid #8b4513;
            padding-bottom: 10px;
        }

        .evidence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .evidence-item {
            background: rgba(60, 30, 15, 0.8);
            border: 2px solid #8b4513;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .evidence-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.2), transparent);
            transition: left 0.5s;
        }

        .evidence-item:hover::before {
            left: 100%;
        }

        .evidence-item:hover {
            border-color: #d4af37;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            transform: translateY(-5px);
        }

        .evidence-item h3 {
            font-family: 'Cinzel', serif;
            color: #cd853f;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .evidence-item p {
            color: #d4c5a9;
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .evidence-link {
            display: inline-block;
            color: #d4af37;
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-size: 0.9em;
            letter-spacing: 1px;
            border: 1px solid #8b4513;
            padding: 8px 20px;
            transition: all 0.3s ease;
            background: rgba(139, 69, 19, 0.2);
        }

        .evidence-link:hover {
            background: rgba(212, 175, 55, 0.3);
            border-color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4);
        }

        .instructions {
            background: rgba(20, 40, 20, 0.4);
            border: 2px solid #2d5016;
            padding: 25px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .instructions h3 {
            font-family: 'Cinzel', serif;
            color: #90ee90;
            margin-bottom: 15px;
        }

        .instructions ul {
            list-style: none;
            padding-left: 0;
        }

        .instructions li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .instructions li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #8b4513;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px solid #8b4513;
            font-size: 0.9em;
            color: #8b7355;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }
            
            .container {
                padding: 20px;
            }
            
            .evidence-grid {
                grid-template-columns: 1fr;
            }

            .detective-icon {
                font-size: 36px;
                top: 15px;
                left: 15px;
            }
        }

        /* Investigation Toolkit Modal - Victorian Theme */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 10, 10, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-overlay.hidden {
            display: none;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(60, 30, 15, 0.95), rgba(40, 20, 10, 0.95));
            border: 3px solid #8b4513;
            border-radius: 5px;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 25px;
            box-shadow: 0 0 50px rgba(139, 69, 19, 0.5);
            position: relative;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #8b4513;
            padding-bottom: 15px;
        }

        .modal-header h3 {
            font-family: 'Cinzel', serif;
            color: #d4af37;
            font-size: 1.3em;
            margin-bottom: 8px;
        }

        .feature-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .feature-btn {
            background: rgba(139, 69, 19, 0.3);
            border: 2px solid #8b4513;
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: #d4c5a9;
            font-family: 'Crimson Text', serif;
            font-weight: 600;
        }

        .feature-btn:hover {
            background: rgba(139, 69, 19, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(139, 69, 19, 0.3);
        }

        .feature-btn.active {
            background: rgba(212, 175, 55, 0.4);
            border-color: #d4af37;
            color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4);
        }

        .feature-icon {
            font-size: 1.5em;
            display: block;
            margin-bottom: 5px;
        }

        .instructions-content {
            display: none;
        }

        .instructions-content.active {
            display: block;
        }

        .quick-steps {
            background: rgba(40, 20, 10, 0.5);
            border-left: 3px solid #8b4513;
            padding: 12px;
            margin-bottom: 12px;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .quick-steps strong {
            color: #d4af37;
            display: block;
            margin-bottom: 6px;
        }

        .quick-steps ul {
            color: #d4c5a9;
            padding-left: 20px;
            line-height: 1.6;
        }

        .close-modal-btn {
            display: block;
            width: 100%;
            margin-top: 20px;
            background: linear-gradient(135deg, #8b4513, #cd853f);
            color: #1a0a0a;
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(139, 69, 19, 0.6);
        }

        .toolkit-btn {
            display: inline-block;
            background: rgba(139, 69, 19, 0.4);
            border: 2px solid #8b4513;
            color: #d4af37;
            padding: 10px 20px;
            border-radius: 5px;
            font-family: 'Cinzel', serif;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .toolkit-btn:hover {
            background: rgba(139, 69, 19, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(139, 69, 19, 0.4);
        }

        /* Print Case Button - Victorian Style */
        .print-case-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #8b4513, #cd853f);
            color: #1a0a0a;
            border: 2px solid #d4af37;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.5);
            transition: all 0.3s ease;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Cinzel', serif;
        }
        
        .print-case-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.6);
        }
        
        .print-case-btn svg {
            width: 20px;
            height: 20px;
            fill: #1a0a0a;
        }

        /* Loading overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 10, 10, 0.95);
            z-index: 10002;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            border: 5px solid rgba(139, 69, 19, 0.3);
            border-top: 5px solid #8b4513;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #d4af37;
            font-size: 1.2em;
            font-family: 'Cinzel', serif;
        }

        @media print {
            .print-case-btn {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Investigation Toolkit Modal -->
    <div id="instructionsModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üõ†Ô∏è Investigator's Toolkit</h3>
                <p style="color: #d4c5a9; font-size: 0.85em; margin: 0;">Select required assistance:</p>
            </div>

            <div class="feature-buttons">
                <div class="feature-btn active" onclick="showFeature('translate')">
                    <span class="feature-icon">üåê</span>
                    Translation
                </div>
                <div class="feature-btn" onclick="showFeature('listen')">
                    <span class="feature-icon">üîä</span>
                    Audio Reading
                </div>
            </div>

            <div id="translateContent" class="instructions-content active">
                <div class="quick-steps">
                    <strong>üñ•Ô∏è Chrome / Edge</strong>
                    <ul>
                        <li>Right-click ‚Üí "Translate"</li>
                        <li>Or click translate icon in address bar</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>üçé Safari</strong>
                    <ul>
                        <li>Click aA icon in address bar</li>
                        <li>Select "Translate to [Language]"</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>ü¶ä Firefox</strong>
                    <ul>
                        <li>Install "Firefox Translations" addon</li>
                        <li>Click addon to translate</li>
                    </ul>
                </div>
            </div>

            <div id="listenContent" class="instructions-content">
                <div class="quick-steps">
                    <strong>üåê Microsoft Edge</strong>
                    <ul>
                        <li>Press Ctrl+Shift+U (Windows)</li>
                        <li>Or Cmd+Shift+U (Mac)</li>
                        <li>"Read this page aloud"</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>üñ•Ô∏è Chrome</strong>
                    <ul>
                        <li>Right-click on text</li>
                        <li>Select "Read aloud"</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>ü¶ä Firefox</strong>
                    <ul>
                        <li>Menu (‚ò∞) ‚Üí "Read aloud"</li>
                        <li>Or press Ctrl+Alt+R</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>üçé Safari (Mac)</strong>
                    <ul>
                        <li>Select text ‚Üí Right-click</li>
                        <li>Speech ‚Üí "Start Speaking"</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>üì± iPhone/iPad</strong>
                    <ul>
                        <li>Settings ‚Üí Accessibility ‚Üí Spoken Content</li>
                        <li>Enable "Speak Screen"</li>
                        <li>Swipe down with 2 fingers to listen</li>
                    </ul>
                </div>

                <div class="quick-steps">
                    <strong>üì± Android</strong>
                    <ul>
                        <li>Settings ‚Üí Accessibility ‚Üí Select to Speak</li>
                        <li>Tap accessibility icon, then tap text</li>
                    </ul>
                </div>
            </div>

            <button class="close-modal-btn" onclick="closeInstructions()">
                Commence Investigation
            </button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Preparing case documents...</div>
    </div>

    <div class="detective-icon">üïµÔ∏è</div>

    <div class="container">
        <header>
            <h1>The Blackwood Estate</h1>
            <div class="subtitle">A Most Grievous Murder</div>
            <div class="case-number">CASE NO. 1889-10-31 | INSPECTOR'S FILE</div>
        </header>

        <div class="warning-banner">
            <h2>‚ö† ACTIVE INVESTIGATION ‚ö†</h2>
            <p>This case remains under investigation by Scotland Yard. All evidence must be examined with utmost scrutiny.</p>
            <div style="text-align: center;">
                <button class="toolkit-btn" onclick="showInstructions()">üõ†Ô∏è Investigator's Toolkit</button>
            </div>
        </div>

        <div class="case-summary">
            <p><strong>DATE OF INCIDENT:</strong> October 30th, 1889</p>
            <p><strong>LOCATION:</strong> Blackwood Estate, Yorkshire</p>
            <p><strong>DECEASED:</strong> Lord Edmund Blackwood, aged 58</p>
            <p><strong>CAUSE OF DEATH:</strong> Arsenic poisoning (confirmed by post-mortem examination)</p>
            
            <p style="margin-top: 20px;">Lord Edmund Blackwood, industrialist and patriarch of the Blackwood family, was found deceased in his study on the morning of October 31st. The family had gathered for their annual autumn reunion when tragedy struck. Initial investigation revealed traces of arsenic in his system, administered sometime during the evening of October 30th.</p>
            
            <p>Five individuals were present at the estate during the fatal evening. Each had means, motive, and opportunity. Your task is to examine all evidence, cross-reference testimonies, and determine who committed this heinous crime.</p>
        </div>

        <div class="instructions">
            <h3>Investigation Guidelines</h3>
            <ul>
                <li>Examine each piece of evidence carefully</li>
                <li>Note contradictions in testimonies and timelines</li>
                <li>Cross-reference financial records with stated motives</li>
                <li>Pay attention to physical descriptions and alibis</li>
                <li>The solution can be derived entirely from the evidence provided</li>
                <li>Consider both individual actors and potential conspiracies</li>
            </ul>
        </div>

        <section class="evidence-section">
            <h2>Case Files & Evidence</h2>
            <div class="evidence-grid">
                <div class="evidence-item">
                    <h3>üìã Official Case File</h3>
                    <p>Victim profile and detailed dossiers on all five suspects, including physical descriptions and known backgrounds.</p>
                    <a href="case-file.html" class="evidence-link">EXAMINE FILE ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>üî¨ Autopsy Report</h3>
                    <p>Complete post-mortem examination conducted by Dr. William Hartley, including toxicology analysis and time of death estimation.</p>
                    <a href="autopsy-report.html" class="evidence-link">READ REPORT ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>üë• Servant Statements</h3>
                    <p>Testimonies from household staff who observed the family throughout the evening. Multiple witnesses provide crucial details.</p>
                    <a href="servant-statements.html" class="evidence-link">READ STATEMENTS ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>üí∞ Financial Ledger</h3>
                    <p>Estate accounts, debts, insurance policies, and recent transactions revealing financial motives and pressures.</p>
                    <a href="financial-ledger.html" class="evidence-link">EXAMINE LEDGER ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>‚úâÔ∏è Personal Correspondence</h3>
                    <p>Letters, notes, and private communications discovered in the deceased's study and suspect quarters.</p>
                    <a href="personal-correspondence.html" class="evidence-link">READ LETTERS ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>‚öóÔ∏è Medicine Inventory</h3>
                    <p>Complete accounting of medicinal compounds, tonics, and substances kept at the estate, including recent access records.</p>
                    <a href="medicine-inventory.html" class="evidence-link">REVIEW INVENTORY ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>‚è∞ Timeline Reconstruction</h3>
                    <p>Hour-by-hour account of the fatal evening, compiled from multiple witness statements and physical evidence.</p>
                    <a href="timeline.html" class="evidence-link">REVIEW TIMELINE ‚Üí</a>
                </div>

                <div class="evidence-item">
                    <h3>üé≠ Police Interrogations</h3>
                    <p>Formal statements given to Scotland Yard by all five suspects following the discovery of the body.</p>
                    <a href="police-interrogations.html" class="evidence-link">READ INTERROGATIONS ‚Üí</a>
                </div>
            </div>
        </section>

        <footer>
            <p>Scotland Yard - Criminal Investigation Division</p>
            <p>All evidence is confidential and for investigative purposes only</p>
            <p style="margin-top: 15px; font-style: italic;">"The truth, however distressing, must come to light."</p>
        </footer>
    </div>

    <!-- Print Case File Button -->
    <button class="print-case-btn" onclick="printAllPages()">
        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd"></path>
        </svg>
        Print Case
    </button>

    <script>
        // Investigation Toolkit Modal
        function showInstructions() {
            const modal = document.getElementById('instructionsModal');
            modal.classList.remove('hidden');
        }

        function closeInstructions() {
            const modal = document.getElementById('instructionsModal');
            modal.classList.add('hidden');
        }

        function showFeature(feature) {
            const buttons = document.querySelectorAll('.feature-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.closest('.feature-btn').classList.add('active');

            const contents = document.querySelectorAll('.instructions-content');
            contents.forEach(content => content.classList.remove('active'));
            
            if (feature === 'translate') {
                document.getElementById('translateContent').classList.add('active');
            } else if (feature === 'listen') {
                document.getElementById('listenContent').classList.add('active');
            }
        }

        document.addEventListener('click', function(event) {
            const modal = document.getElementById('instructionsModal');
            if (event.target === modal) {
                closeInstructions();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeInstructions();
            }
        });

        // Print All Pages Functionality - Victorian Case
        const CASE_PAGES = [
            'case-file.html',
            'autopsy-report.html',
            'servant-statements.html',
            'financial-ledger.html',
            'personal-correspondence.html',
            'medicine-inventory.html',
            'timeline.html',
            'police-interrogations.html'
        ];

        async function printAllPages() {
            document.getElementById('loadingOverlay').classList.add('active');

            try {
                const printWindow = window.open('', '_blank', 'width=800,height=600');
                
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>The Blackwood Estate Mystery - Case File</title>
                        <style>
                            @page {
                                margin: 2cm;
                                size: A4;
                            }
                            
                            * {
                                margin: 0;
                                padding: 0;
                                box-sizing: border-box;
                            }
                            
                            body {
                                font-family: 'Garamond', 'Georgia', 'Times New Roman', serif;
                                font-size: 11pt;
                                line-height: 1.6;
                                color: #000;
                                background: #fff;
                            }
                            
                            .page-break {
                                page-break-after: always;
                                page-break-inside: avoid;
                                margin: 50px 0;
                                border-top: 3px double #333;
                                padding-top: 30px;
                            }
                            
                            h1 {
                                color: #5a3a1a;
                                border-bottom: 3px solid #8b4513;
                                padding-bottom: 10px;
                                margin-bottom: 20px;
                                font-size: 24pt;
                                page-break-after: avoid;
                                text-align: center;
                            }
                            
                            h2 {
                                color: #333;
                                margin-top: 25px;
                                margin-bottom: 15px;
                                font-size: 18pt;
                                page-break-after: avoid;
                            }
                            
                            h3 {
                                color: #555;
                                margin-top: 20px;
                                margin-bottom: 10px;
                                font-size: 14pt;
                                page-break-after: avoid;
                            }
                            
                            p {
                                margin-bottom: 12px;
                                text-align: justify;
                            }
                            
                            table {
                                width: 100%;
                                border-collapse: collapse;
                                margin: 15px 0;
                                page-break-inside: avoid;
                            }
                            
                            th, td {
                                border: 1px solid #333;
                                padding: 8px;
                                text-align: left;
                            }
                            
                            th {
                                background: #f0f0f0;
                                font-weight: bold;
                            }
                            
                            ul, ol {
                                margin-left: 25px;
                                margin-bottom: 12px;
                            }
                            
                            li {
                                margin-bottom: 6px;
                            }
                            
                            img {
                                max-width: 100%;
                                height: auto;
                                page-break-inside: avoid;
                                margin: 15px 0;
                            }
                            
                            .classified {
                                background: #8b4513;
                                color: #fff;
                                padding: 5px 15px;
                                display: inline-block;
                                font-weight: bold;
                                margin: 10px 0;
                            }
                            
                            .info-box {
                                border: 2px solid #8b4513;
                                padding: 15px;
                                margin: 15px 0;
                                background: #f9f9f9;
                                page-break-inside: avoid;
                            }
                            
                            .evidence-item {
                                margin: 20px 0;
                                padding: 15px;
                                border-left: 4px solid #8b4513;
                                background: #fafafa;
                                page-break-inside: avoid;
                            }
                            
                            strong {
                                font-weight: bold;
                                color: #000;
                            }
                            
                            nav, button, .btn, a[href*="hint"], a[href*="solution"], .no-print, .evidence-link {
                                display: none !important;
                            }
                        </style>
                    </head>
                    <body>
                        <h1>THE BLACKWOOD ESTATE MYSTERY</h1>
                        <div class="classified">SCOTLAND YARD - CONFIDENTIAL</div>
                        <p><strong>Case Number:</strong> 1889-10-31</p>
                        <p><strong>Victim:</strong> Lord Edmund Blackwood</p>
                        <p><strong>Print Date:</strong> ${new Date().toLocaleDateString()}</p>
                        <div class="page-break"></div>
                    </body>
                    </html>
                `);

                let loadedPages = 0;
                for (const page of CASE_PAGES) {
                    try {
                        const response = await fetch(page);
                        const html = await response.text();
                        
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        
                        const bodyContent = doc.querySelector('body');
                        if (bodyContent) {
                            const elementsToRemove = bodyContent.querySelectorAll(
                                'nav, button, .btn, script, style, .no-print, a[href*="hint"], a[href*="solution"], header, footer, .evidence-link, .detective-icon'
                            );
                            elementsToRemove.forEach(el => el.remove());
                            
                            if (loadedPages > 0) {
                                printWindow.document.body.innerHTML += '<div class="page-break"></div>';
                            }
                            
                            printWindow.document.body.innerHTML += bodyContent.innerHTML;
                            loadedPages++;
                        }
                    } catch (error) {
                        console.error(`Error loading ${page}:`, error);
                    }
                }

                document.getElementById('loadingOverlay').classList.remove('active');

                setTimeout(() => {
                    printWindow.print();
                }, 500);

            } catch (error) {
                console.error('Error preparing print:', error);
                document.getElementById('loadingOverlay').classList.remove('active');
                alert('Error preparing case file for printing. Please try again.');
            }
        }
    </script>
</body>
</html>
